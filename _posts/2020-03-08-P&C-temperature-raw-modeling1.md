---
title: "[DACON] AI프렌즈 시즌1 온도 추정 경진대회 - 기본 모델링_1"
excerpt: 온도 추정 경진대회의 데이터 탐색 내용입니다.
categories:
- P&C
toc : true
tags:
- 공모전
- 기본 모델링
- 기후
- 온도
- 센서
last_modified_at: 2020-03-08
---






# AI프렌즈 온도 추정 경진대회 기본 모델링_1

[작업 파일 1 : label 만들기](https://github.com/sirzzang/data_competition/blob/master/[temperature]Y18_fillna_byStats.ipynb)

[작업 파일 2 : 채운 훈련세트에 대해 모델링 진행 후 점수 확인]()

[작업 파일 3 : 중간값으로 채운 훈련세트에 대해 모델링 진행 후 점수 확인]()



> 지난 회의(20200306) 이후, Y18의 값을 만들어 기본적인 모델링을 진행하고 그 결과를 확인하기로 했다. 그 중 내가 맡은 부분의 작업(평균값, 중간값 활용하여 채우고, 기본 모델링 진행)을 진행한다.





## *작업 내용 요약*



**label 만들기**

1. Y00~Y17 까지의 **평균**, **중간값**을 활용해 Y18의 결측치를 채웠다.
2. 평균값으로 채웠을 때, 중간값으로 채웠을 때 각각에 대해 Y00~Y17까지의 열을 drop한 후,  train data로 저장한다.



**label 만든 후 상관관계 확인**

계층적 샘플링을 진행할 때, 어떤 열을 활용할지 결정하기 위한 목적에서 진행했다.



**모델링**

조정할 파라미터의 수가 많지 않은 모델 여러 개를 시도하고, 이후 가장 가능성 있는 모델을 선정하여 특성 공학, 파라미터 튜닝 등을 진행하며 성과를 향상시키기 위한 목적이다.

1. 계층적 샘플링 진행

   * 평균값으로 채웠을 때, 중간값으로 채웠을 때 모두 X32가 가장 상관관계가 높게 나왔다.
   * X32 열의 값을 5개의 구간으로 나누고, `StratifiedShuffleSplit`을 활용해 계층적 샘플링을 진행한다.

2. 기본 모델 설계

   * [scikit-learn 지도학습](https://scikit-learn.org/stable/supervised_learning.html)에서, 기본적으로 활용할 수 있을 만한 regressor 알고리즘을 사용한다.
     * linear regression model
     * SVM(linear kernel)
     * decision tree model
     * bayesian regression model
     * nearest neighbors regression model
   * 다음의 지도학습 알고리즘 분류표에 따라, scaling을 진행해야 하는 알고리즘에서만 scaling을 진행한다.

   ![supervised learning algorithms]({{site.url}}/assets/images/model_scaling.png)

3. `random_state` 42로 설정
4. 10겹 교차검증 진행 : `neg_mean_sqared_error`
5. 파라미터 조정
   * 기본적으로 `GridSearchCV`를 사용한다.
   * 성능이 더 향상될 여지가 있다고 판단되면, `GridSearchCV`의 best parameter 이후의 범위에서 `RandomizedSearchCV` 사용한다.
6. 점수가 가장 좋게 나온 모델에 대해, [DACON 점수 측정 함수](https://newfront.dacon.io/competitions/official/235584/overview/)를 적용해 보고, 리더보드에 제출하여 그 차이를 판단한다.





## label 만들기

평균, 중간값을 활용해 Y18을 채우는 작업은 어렵지 않게 진행되었다.



### 상관관계 확인

오히려 새롭게 label을 만들고, Y18과 X00~X39 중 어떤 열이 상관관계가 높은지 판단하는 작업을 다시 진행했다. 

* [첫 데이터 탐색 단계](https://sirzzang.github.io/P&C-temperature-data-exploration1/)에서와는 달리, 센서 데이터만을 활용해 라벨을 만들었으므로, 상관관계가 어떻게 달라질지 궁금했다.
* 이후 계층적 샘플링을 진행할 때, 어떤 열을 기준으로 삼을 지 판단할 수 있다.



**평균값으로 채운 경우**

**양의 상관관계**

| 0.9 이상 | 0.4 이상<br />0.7 미만 |
| :------: | :--------------------: |
|   X32    |          X26           |
|   X31    |          X24           |
|   X00    |          X18           |
|   X07    |          X34           |
|   X28    |          X11           |
|          |          X25           |
|          |          X17           |
|          |          X03           |

* 강한 양의 상관관계 : X00, X07, X28, X31, X32 = 전부 기온이고, 0.9 이상.
* 중간 수준의 양의 상관관계 : 특이하게, 0.9 이하인 것 중 가장 큰 값은 0.599이다.
  * X26, X24, X18, X03 : 풍속
  * X34, X11 : 일일 누적일사량
  * X25, X17 : 풍향
* 이전과는 달리 중간 수준의 양의 상관관계에서 큰 0.6 이상인 것이 없지만, 중간 수준의 상관관계로 분류되는 항목은 늘어났다.
* 일일 누적일사량의 경우, 일별 일사량으로 나누기로 했기 때문에 현재 단계에서는 큰 의미를 부여하지 않는다.
* 계층적 샘플링을 진행할 때는, X32를 기준으로 한다.



**음의 상관관계**

| -0.7 이하 | -0.7 초과<br />-0.4 이하 |
| :-------: | :----------------------: |
|    X12    |           X38            |
|    X30    |                          |
|    X37    |                          |
|    X20    |                          |

* 강한 음의 상관관계, 중간 수준의 음의 상관관계 모두 습도이다.
* X38보다 작은 음의 상관관계는 전부 -0.17 이하로, 이전과 다른 양상을 보인다.



**중간값으로 채운 경우**

**양의 상관관계**

| 0.9 이상 | 0.4 이상<br />0.7 미만 |
| :------: | :--------------------: |
|   X32    |          X26           |
|   X00    |          X24           |
|   X31    |          X18           |
|   X07    |          X25           |
|   X28    |          X34           |
|          |          X11           |
|          |          X17           |
|          |          X03           |

* 순서만 다를 뿐, 평균값으로 채웠을 때와 같은 양상을 보인다.
* 계층적 샘플링을 진행할 때는, X32를 기준으로 한다.



**음의 상관관계**

| -0.7 이하 | -0.7 초과<br />-0.4 이하 |
| :-------: | :----------------------: |
|    X12    |           X38            |
|    X20    |                          |
|    X30    |                          |
|    X37    |                          |

* 이 역시 순서만 다를 뿐, 평균값으로 채웠을 때와 같은 양상을 보인다.





## 모델링 진행_평균값으로 채웠을 때



### 계층적 샘플링 진행

* 타깃 속성인 Y18과 가장 상관관계가 높게 나타난 X32 속성을 기준으로, 값을 5개의 범주로 나누었다.

![X32 category]({{site.url}}/assets/images/mean_X32_category_hist.png)

* 전체 훈련 데이터에서 X32_cat 열의 비중과, test_size를 0.2로 하여 계층적 샘플링을 진행하고 난 뒤 X32_cat 열의 비중을 살펴보면 다음과 같다.

|      | 전체 train set | strat_train_set | strat_test_set |
| ---- | -------------- | --------------- | -------------- |
| 5.0  | 0.300926       | 0.300973        | 0.300736       |
| 4.0  | 0.229798       | 0.229939        | 0.229232       |
| 6.0  | 0.216330       | 0.216259        | 0.216614       |
| 7.0  | 0.186027       | 0.186004        | 0.186120       |
| 8.0  | 0.066919       | 0.066825        | 0.067298       |



### 트리 기반 모델

scaling을 진행하지 않고 모델링한다.















# 논의하고 싶은 내용







